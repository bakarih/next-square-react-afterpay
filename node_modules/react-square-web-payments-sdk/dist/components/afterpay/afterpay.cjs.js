"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});var w=require("react"),l=require("../../contexts/afterpay/afterpay.cjs.js"),v=require("../../hooks/use-event-listener.cjs.js"),E=require("../../contexts/form/form.cjs.js"),A=require("./afterpay.styles.cjs.js");function j(e){if(e&&e.__esModule)return e;var r=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});return e&&Object.keys(e).forEach(function(a){if(a!=="default"){var c=Object.getOwnPropertyDescriptor(e,a);Object.defineProperty(r,a,c.get?c:{enumerable:!0,get:function(){return e[a]}})}}),r.default=e,Object.freeze(r)}var t=j(w);function d({Button:e,buttonColor:r="black",buttonType:a="buy_now_with_afterpay",finalCtaButtonType:c="buy_now",id:s="rswps-afterpay-button",...f}){const u=t.useRef(null),n=l.useAfterpay(),{cardTokenizeResponseReceived:i}=E.useForm(),y=t.useMemo(()=>({buttonColor:r,buttonType:a,finalCtaButtonType:c,useCustomButton:Boolean(e)}),[e,r,a,c]),g=async p=>{if(p.stopPropagation(),!n){console.warn("Afterpay/Clearpay button was clicked, but no Afterpay/Clearpay instance was found.");return}try{const o=await n.tokenize();if(o.status==="OK")return i(o);let m=`Tokenization failed with status: ${o?.status}`;if(o?.errors)throw m+=` and errors: ${JSON.stringify(o?.errors)}`,new Error(m);console.warn(m)}catch(o){console.error(o)}};return t.useEffect(()=>(n&&n?.attach(`#${s}`,y),()=>{n&&n?.destroy()}),[n]),v.useEventListener({listener:g,type:"click",element:u,options:{passive:!0}}),e?t.createElement(e,{...f,id:s,ref:u}):t.createElement("div",{...f,id:s,ref:u},n?null:t.createElement(A.ButtonLoader,null))}function M({badgeTheme:e="black-on-mint",component:r,id:a="rswps-afterpay-message",modalLinkStyle:c="circled-info-icon",modalTheme:s="mint",size:f="md",...u}){const n=t.useRef(null),i=l.useAfterpay(),y=t.useMemo(()=>({badgeTheme:e,modalLinkStyle:c,modalTheme:s,size:f}),[e,c,s,f]);t.useEffect(()=>{const o=async()=>{await i?.attachMessaging(`#${a}`,y)};i&&!r?.Message&&o()},[i,r?.Message,y]);const g=async o=>{o.stopPropagation(),i?.displayInformationModal({modalTheme:s})};v.useEventListener({listener:g,type:"click",element:n,options:{passive:!0}});const p=r?.Message;return p?t.createElement(p,{...u,id:a,ref:n}):t.createElement("div",{...u,id:a})}function b({includeBranding:e,id:r="rswps-afterpay-widget",...a}){const c=t.useRef(null),s=l.useAfterpay();return t.useEffect(()=>{s&&(async()=>{await s?.attachCheckoutWidget(`#${r}`,{includeBranding:e})})()},[s,e]),t.createElement("div",{...a,id:r,ref:c})}function _(e){return t.createElement(l.default,null,t.createElement(d,{...e}))}exports.AfterpayContext=l.AfterpayContext;exports.AfterpayProvider=l.default;exports.AfterpayButton=d;exports.AfterpayMessage=M;exports.AfterpayWidget=b;exports.default=_;
//# sourceMappingURL=afterpay.cjs.js.map
